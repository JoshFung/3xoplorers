pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
--flags
-- 0=minigame initiator
-- 3=textbox
-- 4=wall

function _init()
 state="title"
 
 title_timer=0
 title_color=1
 
 iplayer()
 isel()
 icutscene()
end

function _update()
 --title screen
 if state=="title" then
  if (btnp(❎) or btnp(🅾️)) then
   state="play"
  end
  title_timer+=1
     if title_timer>2 then
      title_color+=1
      title_timer=0
     end
     if title_color>14 then
      title_color=1
     end
 end
 
 --play
 if state=="play" then
     uplayer()
 end
 
 if state=="textbox" then
  utxt()
 end
 
 if state=="selectionbox" then
  usel()
 end
 
 if state=="cutscene" then
  ucutscene()
 end
end

function _draw()
 if state=="play" then
  cls(0)
  map()
  dplayer()
 elseif state=="title" then
  cls(5)
  print("exoplorer",45,50,title_color)
        print("press ❎/🅾️ to play",27,65,13)
 elseif state=="minigame" then
  cls(5)
  print("minigame screen",35,50,7)
 elseif state=="textbox" then
  dtxt()
 elseif state=="selectionbox" then
  dsel()
 elseif state=="cutscene" then
  dcutscene()
 end
 
end
-->8
--player functions
function iplayer()
 player={
  x=10,
  y=110,
  spd=1,
  sprite=72
 }
 
 sprcounter=0
 spranim=0
end

function uplayer()
 local ptx=(player.x+8)/8
 local pty=(player.y+8)/8
 

 
 if btn(⬆️) or btn(⬇️) or btn(➡️) or btn(⬅️) then
  sprcounter+=.1
  if flr(sprcounter)%2==0 then
   spranim=0
  else spranim=1 end
 end
 if btn(⬆️) then
  player.y-=player.spd
  if fget(mget(ptx,pty),4) then
   player.y+=player.spd
  end
  if spranim==1 then
  	player.sprite=76
  else player.sprite=78 end
 end
 if btn(⬇️) then
  player.y+=player.spd
  if spranim==1 then
   player.sprite=72
  else player.sprite=74 end
 end
 if btn(➡️) then
  player.x+=player.spd
  if spranim==1 then
   player.sprite=64
  else player.sprite=66 end
 end
 if btn(⬅️) then
  player.x-=player.spd
  if spranim==1 then
 	 player.sprite=68
 	else player.sprite=70 end
 end

 if fget(mget(ptx,pty),0) then
  if btnp(🅾️) then
   state="selectionbox"
  end
 end

 if fget(mget(ptx,pty),3) then
  if btnp(🅾️) then
   state="textbox"
  end
 end

end

function dplayer()
 spr(player.sprite,player.x,player.y,2,2)
end
-->8
--textbox functions

function itxt()
end

function utxt()
 if btnp(❎) then
  state="play"
 end
end

function dtxt()
 rectfill(10,90,118,112,7)
 rect(10,90,118,112,1)
 print("knowledge",12,92,5)
 print("❎",110,106,5)
end
-->8
--selection box functions

function isel()
 seltable={"yes","no"}
 selected=1
end

function usel()
 if btnp(➡️) then
  if selected==1 then
   selected+=1
  end
 elseif btnp(⬅️) then
  if selected==2 then
   selected-=1
  end
 end
 
 if (selected==1 and btnp(❎)) then
  state="cutscene"
 elseif (selected==2 and btnp(❎)) then
  state="play"
 end
end

function dsel()
 rectfill(30,60,98,92,7)
	rect(30,60,98,92,1)
	rectfill(24+22*selected,78,40+22*selected,86,13)
	for i=1,#seltable do
	 print(seltable[i],27+22*i,80,1)
	end
	print("start minigame?",35,68,1)
 print("❎",110,106,5)
end
-->8
--cutscene functions
function icutscene()
 parts={}
 stars={}
 startimer=0
end

function ucutscene()
 startimer+=1
 if startimer>2 then
 
	 add(stars,{
		 x=rnd(128),
		 y=-10,
		 c=7,
		 speed=.3+rnd(2)
	 })
	 startimer=0
	end

 
 for s in all(stars) do
  s.y+=s.speed
  if s.y>128 then
   del(stars,s)
  elseif s.speed<2 and s.speed>1 then
 	 s.c=6
 	elseif s.speed<=1 then
 	 s.c=5
 	end
 end
 
 for i=1,4 do
	 add(parts,{
	  x=58+rnd(12),
	  y=86+rnd(5),
	  r=2+rnd(2),
	  c=10,
	  speed=1+rnd(2)
	 })
 end

 for p in all(parts) do
  p.y+=p.speed
  p.r-=.1
  if p.r<0 then
   del(parts,p)
  end
  if p.r>3 then
   p.c=10
  elseif p.r<=3 and p.r>1 then
   p.c=9
  elseif p.r<=1 then
   p.c=5
  end
 end
end

function dcutscene()
 cls()
 for p in all(parts) do
  circfill(p.x,p.y,p.r,p.c)
 end
 
 for s in all(stars) do
  pset(s.x,s.y,s.c)
 end
 
 spr(128,48,56,4,4)
end
__gfx__
000000004444424455555555555555555555555555555555555555555555555555555555411111111111111455555555cc555555010001000010001000000000
0000000044444244555555555566666666666655556666555566665555555566665555554166666666666614556666ccccc666551e111e1001e111e100000000
0070070022222222555555555666666666666665566666655666666555555666666556652166666666666612566666ccccc666651eeeeee11eeeeee100000000
000770004424444455555555566666666666666556666665566666655555566666655665415555555555551456666ccccccc66651eeeeee11eeeeee100000000
000770004424444455555555566666666666666556666665566666655665566666655555415777777777751456666ccccccc66651e7eee7117eee7e100000000
0070070044244444555555555666666666666665566666655666666556655666666555554157117717117514566666ccccc666651eeeeee11eeeeee100000000
0000000022222222555555555666666666666665556666555566665555555566665555552157777777777512566666ccccc66665012112100121121000000000
00000000444442445555555556666666666666655555555555555555555555555555555511555555555555115666666cccc66665011011000011011000000000
00000000000000000000000056666666666666655555555555555555555555555555555516666666666666615666666666666665010000100100001000000000
000000000000000000000000566666666666666555666666666666555566665555666655165656565656556156666666666666651e1111e11e1111e100000000
000000000000000000000000566666666666666556666666666666655666666556666665166666666666666156666666666666651eeeeee11eeeeee100000000
000000000000000000000000566666666666666556666666666666655666666556666665111111111111111156666666666666651eeeeee11eeeeee100000000
0000000000000000000000005666666666666665566666666666666556666665566666651555555555555551566666666666666517eeee711eeeeee100000000
000000000000000000000000566666666666666556666666666666655666666556666665155555555555555156666666666666651eeeeee11eeeeee100000000
00000000000000000000000055666666666666555566666666666655556666555566665515555555555555515566666666666655012112100121121000000000
00000000000000000000000055555555555555555555555555555555555555555555555511111111111111115555555555555555011001100110011000000000
00000000000000000000000055555555555555555555555555555555000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000055666666666666555566666666666655000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056666111111666655666666666666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056611666666116655666666111166665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056611666666611655666661166116665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056661666666661655666661666166665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056661666666661655666666661666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056661666666661655666666611666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056661666666661655666666116666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056661666666616655666666166666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056661166666616655666666666666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056666611111166655666666666666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056666666666666655666666166666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000056666666666666655666666666666665000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000055666666666666555566666666666655000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000055555555555555555555555555555555000000000000000000000000000000000000000000000000000000000000000000000000
00000000001000000000000000000000000100000000000000000000000000000000100000000000000000000000000000000000000000000000000000010000
00000000014100000000000000100000001410000000000000010000000000000001410000010000000010000000000000000000000100000000100000141000
00000000011110000000000001410000001111000000000000141000000000000001110000141000000141000001000000001000001410000001410000111000
00000000114141000000000001111000001414110000000000111100000000000001411111141000000111000014100000014100001110000001411111141000
00000001444444100000000011414100014444441000000000141411000000000001444444441000000141111114100000014111111410000001444444441000
00000001444449100000000144444410019444441000000001444444100000000001944444491000000144444444100000014444444410000001444444441000
00000001444444100000000144444910014444441000000001944444100000000001444444441000000194444449100000014444444410000001444444441000
00000000114111000000000144444410001141110000000001444444100000000000114111110000000144444444100000014444444410000000111114110000
00001111114110000000111111411100000141111111000000114111111100000000014111100000000011411111000000001111141100000000011114100000
00114444444441000011444444444100001444444444110000144444444411000001144444411000000114444441100000011444444110000001144444411000
01444444444444100144444444444410014444444444441001444444444444100014444444444100001444444444410000144444444441000014444444444100
01444444444464100144444444446410014444444444441001444444444444100014444464844100001444446484410000144444444441000014444444444100
01444444444444100144444444444410014444444444441001444444444444100014444444444100001444444444410000144444444441000014444444444100
0111d511111d511001115d111115d1100111d511111d511001115d111115d11000115511115511000011dd1111dd11000011dd1111dd11000011551111551100
00015d100015d1000001d510001d510000015d100015d1000001d510001d51000001dd1001dd1000000155100155100000015510015510000001dd1001dd1000
00011110001111000001111000111100000111100011110000011110001111000001111001111000000111100111100000011110011110000001111001111000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000007777700000000000000111111111111111111111111112222221111111111111111111111111222222111111111111111122211111122111112
0000000000000777760000000000000011111111111111111222222221111111100000000000000000000000000000011d1111111111111111111111111111d1
00000000000077777660000000000000120000000000000000000000000000011099999999999999999999999999990111100000000000000000000000000111
00000000000077000660000000000000120000000000000000000000000000011099979999999999999999999999990111100767676967626767676767700111
000000000000770006600000000000001206609909906600ddd09292929299011099777999999999999999999997990111107777676967726767677767770111
000000000000700000600000000000001206609909906600ddd09992999299011097979977779777999797777979790111107777677967726777677767770111
000000000005777666650000000000001200000000000000d1d09992999999011097799799997999799999999997990111107777777977727777777777770111
000000000005576666550000000000001209908809909900d1d09999999999011099997999999797999999999999990111106666666966626666666666660111
000000000015755555651000000000001209908809909900d1d00000000000011099979999999977999999999997990111107777777977727777777777770111
000000000115777666651100000000001200000000000000d1d0ddd0ddd088011099979999999779999977797979790111100000000000000000000000000111
0000000111157776666511110000000012099066099099000100d1d0d1d08801209997999997797999999999999799011110c09060000000660880ccc0000111
0000000111757766666571110000000012099066099099007760d9d0dcd088011099977999799799977999999999990111100000000000000000000000000111
0000000117755766665577110000000012000000000000007660d9d0dcd00001109979979799799979979999999799011d1111111111111111111111111111d1
0000000117757555556577110000000012099099099088006660d9d0dcd099011099799979779999799799997979790111100000001111999111111111111111
0000000117757776666577110000000012099099099088000000d9d0dcd09901109799779799999997799999999799011110ccccc01000999000000000000111
000000111765777666657711100000001200000000000000000009000c000001109977999999999999999999999999012210ccccc01111999111111111111112
0000001177657776666577711000000012000000000000000000000000000001109999999999999999999999999999011210ccccc01111111111111111111112
00000111766575766565777711000000122222222225555555555555555555511000000000000000000000000000000112100000001111111111118881111112
000001177665757665657777110000001dddddddddddddddddddddddddddddd11222222222222222222222222222222112106060601000000000008880000112
0000117766657576656577776110000011111111111111111111111111111111111dddddddddddddddddddddddddd11112100000001111111111118881111112
00011177666575766565777661110000100000000000000011111111111111121111dddddddddddddddddddddddd111111106060601111111111111111111112
00111776666575766565776666111000099999999999999901111111111111121111111111111111111111111111111111100000001111111666111111111111
00117776666577666665666666611000099989977797979901111111188111121100000000000000000000000000001111106060601000000666000000000111
00117766666877666668656666611000099878999999999901616161888811121106660606060606060606060606001111100000001111111666111111111111
00117666656886666688656666611000099878979779777901616161888811111100000000000000000000000000001111100000601111111111111111111111
00666655566288888882665556666000098888899999999901111111188111121106606060606060606060660606001111106606601111111111111111111221
00006666666522222225666666600000099999999999999901111111111111111100000000000000000000660000001221100000001111111111111111111121
00006666666576657665666666600000100000000000000011111111111111111106066060666666606060600606001211111111111111111111111111111121
00006666666566656665666666600000110000000000000111111111122221211100000000000000000000000000001211111111111111111122222222211111
00000000000556656655000000000000111111111111111111111122111111111111111111111111111111111111111212221122222222222221111111111111
00000000000055555550000000000000222222211111111111222211222221221111111111111111111111111111111211122221111111111111111111111111
00000000000000000000000000000000111111111111111111111111111111111111122221222222222111211112111211111111111111111111112222222222
111111111111111111111111111111116dddddddddddddd600000000000000000000000000000000000000000000000000000600000000006dddddddddddddd6
11222211111111111111222221111222dddddddddddddddd0000000000000000000000000000000001000000000000000000676000000000dddddddddddddddd
11000000100000000000000000000001dddddddddddddddd0000000000000000000000000001000000000000000000000000060000000000dddddddddddddddd
11000000100000000000000000000001dddddddddddddddddddddddd00000000000600000100000000000000000000000000000000000000ddddddd22ddddddd
11000000105555555555555555886601dddddddddddddddddddddddd00000000000000000000000000000000000001110000000000070000dddddd2222dddddd
11088880105555555555555558856601dddddddddddddddddddddddd000000000600060000000000000000000001111c1100000000000000ddddd222222ddddd
11088880105555555555555558556601dddddddddddddddd11111111000000000000000000111100000000000001111c1100000000000000ddddd222222ddddd
11000000105555555555555585556601dddddddddddddddd111111110000000000060000010000100000000000111cc11c10000000000000dddd22222222dddd
11000000105555555555555855566901dddddddddddddddd000000000000000000000000010000100000000000ccc111c11c000000000000dddd22d22d22dddd
11099990105555555556558556999601dddddddddddddddd00000000000000000000000001000010000000000011111c111cc00000000000dddd2dd22dd2dddd
11099990105556555556885599966601dddddddddddddddd00000000000000000000000001000010000000000001cc1111ccc00000000000ddddddd22ddddddd
11000000105556555568999956666601dddddddddddddddd00000000000000000000000000111100000000000001111111cc000000000000ddddddd22ddddddd
21000000105556555999655556666601dddddddddddddddd0000000000000000000700000000000000600000000001110000000000001110ddddddd22ddddddd
11066660105599999866665566666601dddddddddddddddddddddddd00000000000000000000000660000000000000000000006000001010dddddddddddddddd
11066660109966585566666666666601dddddddddddddddddddddddd00000000000000000000000670000000000000000000000000001110dddddddddddddddd
110000001055668556666666666666016dddddddddddddd6dddddddd000000000000000600000000000000000000000000060000000000006dddddddddddddd6
11000000108888656666666666666601000000000000000000000000000000000000000000000006060000000000000000000000000000000000000000000000
110cccc0106666666666666666666601000000000000000000000222222000000000000000000000000600000000000000000000000000000000000000000000
110cccc010666666666666666666660100000000000000000700222dddd200000000000000000000000000000000000000000000000000000000000000000000
110000001000000000000000000000010000000000000000000222d2222d20000000000000000000000000000000000000000000000000000000000000000000
110000001000000000000000000000010000000000000000002222d2222d22000000000000000000000000000000000000000000000000000000000000000000
1105555010999999999999999999980100000000000000000222222dddd222200000000000055556000000000000000000000000000000000000000000000000
110556501099998999999999998998010000000000000000022222222222dd200000000000555555500000000000000000000000000000000000000000000000
1105566010899989989999989989980100000000000000000222ddd22222d2d00000000005566655550000000000000000000000000000000000000000000000
210566601000000000000000000000010000000000000000022d222d2222d2d00000000055655565555000000000000000000000000000000000000000000000
210666601000000000000000000000010000000000000000022d222d222dd2d00000000055655565556000000000000000000000000000000000000000000000
210000001dddddddddddddddddddddd100000000000000000222ddd222222d200000000055655565565000000000000000000000000000000000000000000000
1111111111dddddddddddddddddddd11000000000000000000222222222222000000000055566655655000000000000000000000000000000000000000000000
11111111111111111111111111111111000000000000000000022222222220000000000005555555560000000000000000000000000000000000000000000000
21111111122211111111111111121111000000000000000000002222d22200000000000000555665500000000000000000000000000000000000000000000000
11111122221112222222221211111111000000000000000000000222222000000000000000056556000000000000000000000000000000000000000000000000
11111111111111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0010000000000000001010010100000000000000000000000010100101000000000000101008080000000000000000000000001010080800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011111010101010101010101000000000000000000000000000000101000000000000000000000000000001010000000000000000000000000000000010101010000000000000000000000000
__map__
0000dd0000000000d800000000dd000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00c8000000e6e700c800d800c800c9ca00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000c9ca00f6f7000000cbcc0000d9da00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000d9da0000cd00cd00dbdccd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00e9ea00dacd00c8c9ca00d800cddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00f9fac800d800d8d9dadd0000c800d800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d6d6d6d6c6c6c6c6c6c6c6c6d6d6d6d600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
8485868788898a8b8c8d8e8fc0c1c2c300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
9495969798999a9b9c9d9e9fd0d1d2d300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
a4a5a6a7a8a9aaabacadaeafe0e1e2e300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
b4b5b6b7b8b9babbbcbdbebff0f1f2f300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
cecfc4c5c4c5c4c5c4c5c4c5c4c5c4c500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
dedfd4d5d4d5d4d5d4d5d4d5d4d5d4d500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
c4c5c4c5c4c5c4c5c4c5c4c5c4c5c4c500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d4d5d4d5d4d5d4d5d4d5d4d5d4d5d4d500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
c4c5c4c5c4c5c4c5c4c5c4c5c4c5c4c500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
d4d5d4d5d4d5d4d5d4d5d4d5d4d5d4d500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
00010000212302223023230242302523027220282202b2102c2102d2102f200302003220033200342003620037200382003820038200372103622035220332202f2702b27024270212601f2501c2501925017250
__music__
00 00424344

